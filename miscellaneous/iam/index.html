<!doctype html>
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.80.0" /><META NAME="ROBOTS" CONTENT="INDEX, FOLLOW">


<link rel="shortcut icon" href="/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/favicons/android-192x192.png" sizes="192x192">

<title>IAM Guidance | Opta</title><meta property="og:title" content="IAM Guidance" />
<meta property="og:description" content="How to configure your iam to work with Opta
" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/miscellaneous/iam/" />
<meta property="article:published_time" content="2020-02-01T00:00:00+00:00" />
<meta property="article:modified_time" content="2021-05-26T14:02:00-07:00" /><meta property="og:site_name" content="Opta" />
<meta itemprop="name" content="IAM Guidance">
<meta itemprop="description" content="How to configure your iam to work with Opta
">
<meta itemprop="datePublished" content="2020-02-01T00:00:00+00:00" />
<meta itemprop="dateModified" content="2021-05-26T14:02:00-07:00" />
<meta itemprop="wordCount" content="1204">



<meta itemprop="keywords" content="" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="IAM Guidance"/>
<meta name="twitter:description" content="How to configure your iam to work with Opta
"/>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-188763285-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>






<link rel="preload" href="/scss/main.min.a4f4923899f9878a84cfd83f594a4cec69ffb2fa0e75cb0d777edae060863ead.css" as="style">
<link href="/scss/main.min.a4f4923899f9878a84cfd83f594a4cec69ffb2fa0e75cb0d777edae060863ead.css" rel="stylesheet" integrity="">


<script
  src="https://code.jquery.com/jquery-3.5.1.min.js"
  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
  crossorigin="anonymous"></script>


<script type="text/javascript">
    (function(e,t){var n=e.amplitude||{_q:[],_iq:{}};var r=t.createElement("script")
    ;r.type="text/javascript"
    ;r.integrity="sha384-girahbTbYZ9tT03PWWj0mEVgyxtZoyDF9KVZdL+R53PP5wCY0PiVUKq0jeRlMx9M"
    ;r.crossOrigin="anonymous";r.async=true
    ;r.src="https://cdn.amplitude.com/libs/amplitude-7.2.1-min.gz.js"
    ;r.onload=function(){if(!e.amplitude.runQueuedFunctions){
        console.log("[Amplitude] Error: could not load SDK")}}
    ;var i=t.getElementsByTagName("script")[0];i.parentNode.insertBefore(r,i)
    ;function s(e,t){e.prototype[t]=function(){
        this._q.push([t].concat(Array.prototype.slice.call(arguments,0)));return this}}
        var o=function(){this._q=[];return this}
        ;var a=["add","append","clearAll","prepend","set","setOnce","unset"]
        ;for(var u=0;u<a.length;u++){s(o,a[u])}n.Identify=o;var c=function(){this._q=[]
            ;return this}
        ;var l=["setProductId","setQuantity","setPrice","setRevenueType","setEventProperties"]
        ;for(var p=0;p<l.length;p++){s(c,l[p])}n.Revenue=c
        ;var d=["init","logEvent","logRevenue","setUserId","setUserProperties","setOptOut","setVersionName","setDomain","setDeviceId", "enableTracking", "setGlobalUserProperties","identify","clearUserProperties","setGroup","logRevenueV2","regenerateDeviceId","groupIdentify","onInit","logEventWithTimestamp","logEventWithGroups","setSessionId","resetSessionId"]
        ;function v(e){function t(t){e[t]=function(){
            e._q.push([t].concat(Array.prototype.slice.call(arguments,0)))}}
            for(var n=0;n<d.length;n++){t(d[n])}}v(n);n.getInstance=function(e){
            e=(!e||e.length===0?"$default_instance":e).toLowerCase()
            ;if(!n._iq.hasOwnProperty(e)){n._iq[e]={_q:[]};v(n._iq[e])}return n._iq[e]}
        ;e.amplitude=n})(window,document);

    amplitude.getInstance().init("3c2edcd34808a6431499f4cd9b034e34");

    amplitude.getInstance().logEvent("Viewed " + document.title + " Page", {
        url: window.location.href,
    });
</script>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />



    <title>IAM Guidance | Opta</title>
  </head>
  <body class="td-page">
    <header>
      
<nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
        <a class="navbar-brand" href="/">
		<span class="navbar-logo"><svg width="113" height="32" viewBox="0 0 113 32" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M11.4425 25.3675 7.86982 20.2459C7.71992 20.2625 7.49507 20.2709 7.19527 20.2709H3.24786V25.3675H0V7.87903H7.19527C8.71093 7.87903 10.0267 8.12886 11.1427 8.62854 12.2753 9.12821 13.1414 9.8444 13.741 10.7771 14.3406 11.7098 14.6404 12.8174 14.6404 14.0999 14.6404 15.4157 14.3156 16.5483 13.666 17.4977 13.0331 18.4471 12.117 19.1549 10.9178 19.6213L14.9402 25.3675H11.4425zM11.3675 14.0999C11.3675 12.984 11.0011 12.1262 10.2682 11.5266 9.53539 10.927 8.4611 10.6272 7.04536 10.6272H3.24786v6.9704H7.04536C8.4611 17.5976 9.53539 17.2978 10.2682 16.6982 11.0011 16.082 11.3675 15.2159 11.3675 14.0999z" fill="#fff"/><path d="M29.7915 25.6174C27.3765 25.6174 25.4944 24.9428 24.1452 23.5937 22.7961 22.2279 22.1216 20.2792 22.1216 17.7475V7.87903H25.3694V17.6226C25.3694 21.0537 26.8518 22.7692 29.8165 22.7692 32.7646 22.7692 34.2386 21.0537 34.2386 17.6226V7.87903H37.4365V17.7475C37.4365 20.2792 36.7619 22.2279 35.4128 23.5937 34.0804 24.9428 32.2066 25.6174 29.7915 25.6174z" fill="#fff"/><path d="M61.5222 7.87903V25.3675H58.849L49.2053 13.5253V25.3675H45.9824V7.87903H48.6557L58.2993 19.7212V7.87903H61.5222z" fill="#fff"/><path d="M96.8415 25.3675 93.2189 19.9461 89.6463 25.3675H84L90.3708 16.5233 84.2748 7.87903H89.8461L93.3438 12.9257 96.7916 7.87903H102.138L96.0421 16.3235 102.538 25.3675H96.8415z" fill="#fff"/><path d="M107.453 32V30.5299H111.248V1.47008H107.453V0H112.957V32H107.453z" fill="#fe794f"/><path d="M72.5.0H78.0043V1.47009H74.2094V30.5299H78.0043V32H72.5V0z" fill="#fe794f"/></svg></span><span class="text-uppercase font-weight-bold">Opta</span>
	</a>
	<div class="td-navbar-nav-scroll ml-md-auto" id="main_navbar">
		<ul class="navbar-nav mt-2 mt-lg-0">
			
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				<a  class="nav-link active" href="/" ><span class="active">Documentation</span></a>
			</li>
			
			
			
		</ul>
	</div>
	<div class="navbar-nav d-none d-lg-block">
<input type="search" class="form-control td-search-input" placeholder="&#xf002 Search this site…" aria-label="Search this site…" autocomplete="off">

</div>
</nav>

    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
            





<div id="td-sidebar-menu" class="td-sidebar__inner">
  
  <form class="td-sidebar__search d-flex align-items-center">
    
<input type="search" class="form-control td-search-input" placeholder="&#xf002 Search this site…" aria-label="Search this site…" autocomplete="off">


    <button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type="button" data-toggle="collapse" data-target="#td-section-nav" aria-controls="td-docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    </button>
  </form>
  
  <nav class="collapse td-sidebar-nav pt-2 pl-4" id="td-section-nav">
    
    






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section">Documentation</a>
  </li>
  <ul>
    <li class="collapse show" id="">
      
      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/overview/" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section">Overview</a>
  </li>
  <ul>
    <li class="collapse show" id="overview">
      
      
      
    </li>
  </ul>
</ul>

      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/getting-started/" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section">Getting Started</a>
  </li>
  <ul>
    <li class="collapse show" id="getting-started">
      
      
      
    </li>
  </ul>
</ul>

      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/installation/" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section">Installation</a>
  </li>
  <ul>
    <li class="collapse show" id="installation">
      
      
      
    </li>
  </ul>
</ul>

      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/miscellaneous/" class="align-left pl-0 pr-2 active td-sidebar-link td-sidebar-link__section">Miscellaneous</a>
  </li>
  <ul>
    <li class="collapse show" id="miscellaneous">
      
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-miscellaneousanalytics" href="/miscellaneous/analytics/">Analytics</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-miscellaneouscontinuous_deployment" href="/miscellaneous/continuous_deployment/">Continuous Deployment</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-miscellaneousdatadog_integration" href="/miscellaneous/datadog_integration/">Datadog Integration</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-miscellaneousdebugging" href="/miscellaneous/debugging/">Debugging</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page  active" id="m-miscellaneousiam" href="/miscellaneous/iam/">IAM</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-miscellaneousingress" href="/miscellaneous/ingress/">Ingress</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-miscellaneoussecrets" href="/miscellaneous/secrets/">Secrets</a>
      
      
    </li>
  </ul>
</ul>

      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/modules-reference/" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section">Modules reference</a>
  </li>
  <ul>
    <li class="collapse show" id="modules-reference">
      
      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/modules-reference/environment-modules/" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section">Environment modules</a>
  </li>
  <ul>
    <li class="collapse show" id="modules-referenceenvironment-modules">
      
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-modules-referenceenvironment-modulesaws" href="/modules-reference/environment-modules/aws/">AWS</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-modules-referenceenvironment-modulesgcp" href="/modules-reference/environment-modules/gcp/">GCP</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-modules-referenceenvironment-modulescloud-agnostic" href="/modules-reference/environment-modules/cloud-agnostic/">Agnostic</a>
      
      
    </li>
  </ul>
</ul>

      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/modules-reference/service-modules/" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section">Service modules</a>
  </li>
  <ul>
    <li class="collapse show" id="modules-referenceservice-modules">
      
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-modules-referenceservice-modulesaws" href="/modules-reference/service-modules/aws/">AWS</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-modules-referenceservice-modulesgcp" href="/modules-reference/service-modules/gcp/">GCP</a>
      
      
    </li>
  </ul>
</ul>

      
      
    </li>
  </ul>
</ul>

      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/architecture/" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section">Architecture &amp; Security</a>
  </li>
  <ul>
    <li class="collapse show" id="architecture">
      
      
      
    </li>
  </ul>
</ul>

      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/tutorials/" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section">Tutorials</a>
  </li>
  <ul>
    <li class="collapse show" id="tutorials">
      
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-tutorialscustom_image" href="/tutorials/custom_image/">Custom Image</a>
      
      
    </li>
  </ul>
</ul>

      
      
    </li>
  </ul>
</ul>

  </nav>
</div>



          </div>
          <div class="d-none d-xl-block col-xl-2 td-toc d-print-none">
            
  
  
  
  
  
  <div class="td-page-meta ml-2 pb-1 pt-2 mb-0">
  
  
    <a id="print" href="/miscellaneous/_print/"><i class="fa fa-print fa-fw"></i> Print entire section</a>
  
  </div>





<nav id="TableOfContents">
  <ul>
    <li><a href="#org--sso">Org + SSO</a></li>
    <li><a href="#new-account">New Account</a>
      <ul>
        <li><a href="#cross-account-access">Cross Account Access</a></li>
        <li><a href="#long-term-credentials">Long Term Credentials</a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li><a href="#basic-management-architecture">Basic management architecture</a>
      <ul>
        <li><a href="#opta-usage">Opta usage</a></li>
        <li><a href="#long-term-credentials-1">Long Term Credentials</a></li>
      </ul>
    </li>
  </ul>
</nav>



          </div>
          <main class="col-12 col-md-9 col-xl-8 pl-md-5" role="main">
            <nav aria-label="breadcrumb" class="d-none d-md-block d-print-none">
	<ol class="breadcrumb spb-1">
		







<li class="breadcrumb-item" >
	<a href="/miscellaneous/">Miscellaneous</a>
</li>




<li class="breadcrumb-item active" aria-current="page">
	<a href="/miscellaneous/iam/">IAM</a>
</li>

	</ol>
</nav	>

            
<div class="td-content">
	<h1>IAM Guidance</h1>
	<div class="lead">How to configure your iam to work with Opta</div>
	<h1 id="overview">Overview</h1>
<p>Identity access management, IAM, is how a user can control permissions to read and/or modify resources in their
cloud accounts. When opta runs, it uses your currently configured credentials for your role/user of your cloud provider
to read your state, and update/create resources as needed. Due to the large amount and variety of resources opta
is responsible for, we recommend folks to use a role/user with account admin privileges for opta, but we hope to
begin providing more specific policies in the future. Furthermore, the k8s cluster needs authentication and
authorization to read and write resources to itself, which is tied to the cloud provider&rsquo;s IAM. Below, we go over the
specifics for the setup for each cloud.</p>
<h1 id="aws">AWS</h1>
<p>When creating a new AWS account, there are two routes you can go by</p>
<ol>
<li>Create and link accounts with <a href="https://docs.aws.amazon.com/organizations/latest/userguide/orgs_tutorials_basic.html">AWS Organizations</a>
and then use <a href="https://docs.aws.amazon.com/singlesignon/latest/userguide/what-is.html">AWS SSO</a> (yes, there are other SSO
options, but we won&rsquo;t cover those).</li>
<li>Create separate AWS accounts the old-fashioned way.</li>
</ol>
<p>We recommend using the AWS Organization route as, although it&rsquo;s a little extra setup, will make your life way easier when
scaling to multiple environments and accounts and AWS accounts themselves don&rsquo;t cost anything so fiscal prudence is not
a problem. Nonetheless, here are the instructions for both routes.</p>
<h2 id="org--sso">Org + SSO</h2>
<p>For this approach, you will need a &ldquo;root account&rdquo; to start with, which you can create via the traditional method. As
the creator, you will be bestowed with admin privileges. From there you can follow the official steps <a href="https://docs.aws.amazon.com/organizations/latest/userguide/orgs_tutorials_basic.html">here</a>
to setup your organization&ndash; you&rsquo;ll want to focus on the &ldquo;Create a member account&rdquo; section, and don&rsquo;t worry about the
organizational units or service control policies for now.</p>
<p>Once that&rsquo;s setup, we can create SSO for your Organization by going to the root AWS account and following the official
<a href="https://docs.aws.amazon.com/singlesignon/latest/userguide/step1.html">steps</a>. You&rsquo;ll want to focus on steps 1, 2, and
3 for now, and for step 2 if you&rsquo;re using gsuite, go ahead and use that as your source by following <a href="https://aws.amazon.com/blogs/security/how-to-use-g-suite-as-external-identity-provider-aws-sso/">this</a>.
Once that&rsquo;s settled, you can <a href="https://docs.aws.amazon.com/singlesignon/latest/userguide/useraccess.html#assignusers">assign user access</a>
to the different accounts in your organization. For opta usage, we recommend to use the SSO Admin access/permission set.</p>
<p><em>NOTE</em> If you want to deploy opta in the root account (which we advise against), feel free to use the New Account section
instructions from down below</p>
<h2 id="new-account">New Account</h2>
<p>Outside of SSO, if one were to use opta then you have to create a new IAM for opta which your human teammates
could then &ldquo;<a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_use.html">assume</a>&rdquo;. This assumption allows IAM
users (and other roles too) to get credentials for the assumed role (time limited) and interact with the AWS API on their
behalf. <em>This way many people can get the same permissions and act as the same entity without compromising their own
personal credentials</em>. For role assumption, two things are required:</p>
<ol>
<li>The role to be assumed must have its trust policy include the role that would assume it (explicitly or through a group).
<img src="/images/iam_tutorial_image_1.png" alt="image alt text"></li>
<li>The assumer role/user must have the IAM permission to assume the opta role.
<img src="/images/iam_tutorial_image_2.png" alt="image alt text"></li>
</ol>
<p>To create such a role and permission, you can start by following the official IAM role creation instructions
<a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_create_for-user.html#roles-creatingrole-user-console">here</a>.
When prompted &ldquo;Specify accounts that can use this role&rdquo; add the own account id. This satisfies requirement 1 as now
the role will be ok with ANY IAM role/user in your account to assume it (you can refine the list later). Continue and
give it the Administrator Access policy (should be one of the first on the list), and create it (you can add tags if you
so wish). Now you have a role capable of executing AWS requests with admin privileges.
<img src="/images/iam_tutorial_image_3.png" alt="image alt text"></p>
<p>To satisfy requirement 2, all you have to do is follow this <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_use_permissions-to-switch.html">guide</a>
for all the IAM users/roles you have in question. You can then test it out by running the following with you current credentials:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">aws sts assume-role --role-arn <span style="color:#4e9a06">&#34;THE_OPTA_ROLE_ARN&#34;</span> --role-session-name DUMMY_SESSION
</code></pre></div><p>The output should be the temporary credentials to assume the opta role. Just set the envars as so:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#204a87">export</span> <span style="color:#000">AWS_ACCESS_KEY_ID</span><span style="color:#ce5c00;font-weight:bold">=</span>RoleAccessKeyID
<span style="color:#204a87">export</span> <span style="color:#000">AWS_SECRET_ACCESS_KEY</span><span style="color:#ce5c00;font-weight:bold">=</span>RoleSecretKey
<span style="color:#204a87">export</span> <span style="color:#000">AWS_SESSION_TOKEN</span><span style="color:#ce5c00;font-weight:bold">=</span>RoleSessionToken
</code></pre></div><p>You can now run opta and any other AWS cli/sdk with the opta role.</p>
<h3 id="cross-account-access">Cross Account Access</h3>
<p>If you want to give a user access to run opta in account a while their IAM role/user is in account b, simply refine
the opta role you created in account a to allow role assumption from account b (again, you can further specify which
iam users/roles are) and make sure that you allowed role assumption in the assumer to the new account.</p>
<h3 id="long-term-credentials">Long Term Credentials</h3>
<p>For long term credentials (e.g. to hardcode into a CI system), we recommend you create an IAM user who can then assume
the role used by opta and using its credentials, assuming the opta role as part of the process.</p>
<h1 id="gcp">GCP</h1>
<h2 id="basic-management-architecture">Basic management architecture</h2>
<p>In GCP, Google has created a distinct IAM/project/org flow which may seems backwards from the AWS model. Due to Google&rsquo;s
wide array of business products, GCP is often tightly integrated, as shall be explained:</p>
<p>Usage of GCP begins by first <a href="https://cloud.google.com/resource-manager/docs/creating-managing-organization">creating the organization</a>
under which all projects (equivalent to AWS accounts) would be created. This is done through either a <a href="https://support.google.com/a/answer/53926">Google Workspace</a>
(formerly called G Suite the same workspace used to setup your company&rsquo;s gmail, Google Calendar, Google Drive, etc&hellip;)
or a <a href="https://cloud.google.com/identity">Cloud Identy</a> (we advise to choose the Google Workspace). The first project
is created automatically upon signing in to GCP for the first time, although you can easily spin up many more as the need
arises, and can even bundle them into folders. Runx currently recommends 1 project per environment.</p>
<p><img src="/images/gcp-org.png" alt="image alt text"></p>
<p>You will, however, need to create at least one <a href="https://cloud.google.com/billing/docs/concepts">billing account</a> and
link it to the project before using any service. A billing account is how payment for GCP is handled, and they exist
as separate entities from the project (under the hood they link to a <a href="https://support.google.com/paymentscenter/topic/9017382?ref_topic=9037778">google payments profile</a>
but most users should not be concerned about this). An organization can have multiple billing accounts which can in turn
be linked to multiple projects to handle their payments (a project can only have 1 linked billing account). In this manner
can a company use different/the same budgets for different projects, and add restrictions or perform analysis as needed.</p>
<p><img src="/images/gcp-billing.png" alt="image alt text"></p>
<p><a href="https://cloud.google.com/iam/docs/overview#concepts_related_identity">IAM for humans</a> can similarly be handled by google
accounts setup in your google workspace/cloud identity, but also private google accounts or Google Groups (again, we
recommend using the workspace). These identities exist outside GCP, so are global to all orgs and can be given
access at the org level, project level, or folder level. As such, cross-account/project access doesn&rsquo;t really apply
and one just needs to ensure they have the desired permissions on the different projects in mind.</p>
<h3 id="opta-usage">Opta usage</h3>
<p>Once a project is setup with a correct billing account, opta only needs to run as a project owner for the given
project (in time opta will create a refined role so the full owner scope is not needed). You can do this by running:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">gcloud auth application-default login
</code></pre></div><h3 id="long-term-credentials-1">Long Term Credentials</h3>
<p>Long term credentials can be generated by creating a service account (akin to AWS IAM roles) with the required permissions
and <a href="https://cloud.google.com/docs/authentication/production#create_service_account">generating service account keys for it</a>.</p>

	
	
	<div class="text-muted mt-5 pt-3 border-top">Last modified May 26, 2021: <a  href="/commit/dc7f95ae32c9700095fdb5fb32d51ca7b528aa28">typo (dc7f95a)</a>
</div>
</div>


          </main>
        </div>
      </div>
      
<footer class="bg-dark py-5 row d-print-none">
  <div class="container-fluid mx-sm-5">
    <div class="row">
      <div class="col-6 col-sm-4 text-xs-center order-sm-2">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="User support list" aria-label="User support list">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="support@runx.dev">
      <i class="fa fa-envelope"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Discord" aria-label="Discord">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://discord.gg/BXjmBhkwvB">
      <i class="fab fa-discord"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-12 col-sm-4 text-center py-2 order-sm-2">
        <small class="text-white">&copy; 2021 RunX Labs Inc. All Rights Reserved</small>
        <small class="ml-1"><a href="https://policies.google.com/privacy" target="_blank">Privacy Policy</a></small>
	
		
	
      </div>
    </div>
  </div>
</footer>


    </div>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" integrity="sha384-w1Q4orYjBQndcko6MimVbzY0tgp4pWB4lZ7lr30WKz0vr/aWKhXdBNmNb5D92v7s" crossorigin="anonymous"></script>











<script src="/js/main.min.b5fc1b29d2465835844254bd4d804738eaf24c0cec53009b4c6899989be55a47.js" integrity="sha256-tfwbKdJGWDWEQlS9TYBHOOryTAzsUwCbTGiZmJvlWkc=" crossorigin="anonymous"></script>



<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
<script type="text/javascript"> docsearch({
        apiKey: '45a325ff63b40a0ee70998f1049e20c3',
        indexName: 'runx',
        inputSelector: '.td-search-input',
        debug: false 
    });
</script>



  </body>
</html>